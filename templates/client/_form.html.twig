{# client/_form.html.twig #}

{{ form_start(form, {'attr': {'class': 'row g-3 needs-validation', 'novalidate': 'novalidate'}}) }}

{# Section Informations client #}
<div class="col-md-6">
	<div class="card mb-4 shadow-sm">
		<div class="card-header bg-primary text-white">
			<h5 class="mb-0">Informations client</h5>
		</div>
		<div class="card-body">
			<div class="mb-3">
				{{ form_label(form.nomClient, 'Nom du client*', {'label_attr': {'class': 'form-label fw-bold'}}) }}
				{{ form_widget(form.nomClient, {'attr': {'class': 'form-control', 'required': 'required'}}) }}
				<div class="invalid-feedback">
					Ce champ est obligatoire
				</div>
			</div>

			<div class="row">
				<div class="col-md-6 mb-3">
					{{ form_label(form.commercial, 'Commercial', {'label_attr': {'class': 'form-label'}}) }}
					{{ form_widget(form.commercial, {'attr': {'class': 'form-select'}}) }}
				</div>
				<div class="col-md-6 mb-3">
					{{ form_label(form.numeroClient, 'Numéro client', {'label_attr': {'class': 'form-label'}}) }}
					{{ form_widget(form.numeroClient, {'attr': {'class': 'form-control'}}) }}
				</div>
			</div>

			<div class="row">
				<div class="col-md-6 mb-3">
					{{ form_label(form.telephoneCabinet, 'Téléphone cabinet', {'label_attr': {'class': 'form-label'}}) }}
					{{ form_widget(form.telephoneCabinet, {'attr': {'class': 'form-control'}}) }}
				</div>
				<div class="col-md-6 mb-3">
					{{ form_label(form.gsmPraticien, 'GSM praticien', {'label_attr': {'class': 'form-label'}}) }}
					{{ form_widget(form.gsmPraticien, {'attr': {'class': 'form-control'}}) }}
				</div>
			</div>

			<div class="mb-3">
				{{ form_label(form.email, 'Email', {'label_attr': {'class': 'form-label'}}) }}
				{{ form_widget(form.email, {'attr': {'class': 'form-control'}}) }}
			</div>
		</div>
	</div>
</div>

{# Section Contrat #}
<div class="col-md-6">
	<div class="card mb-4 shadow-sm">
		<div class="card-header bg-primary text-white">
			<h5 class="mb-0">Détails du contrat</h5>
		</div>
		<div class="card-body">
			<div class="mb-3">
				{{ form_label(form.numeroContrat, 'Numéro de contrat', {'label_attr': {'class': 'form-label'}}) }}
				{{ form_widget(form.numeroContrat, {'attr': {'class': 'form-control'}}) }}
			</div>

			<div class="row">
				<div class="col-md-6 mb-3">
					{{ form_label(form.dateProposition, 'Date proposition', {'label_attr': {'class': 'form-label'}}) }}
					{{ form_widget(form.dateProposition, {'attr': {'class': 'form-control datepicker'}}) }}
				</div>
				<div class="col-md-6 mb-3">
					{{ form_label(form.demarrageContrat, 'Démarrage contrat', {'label_attr': {'class': 'form-label'}}) }}
					{{ form_widget(form.demarrageContrat, {'attr': {'class': 'form-control datepicker'}}) }}
				</div>
			</div>

			<div class="row">
				<div class="col-md-6 mb-3">
					{{ form_label(form.premiereFacturation, 'Première facturation', {'label_attr': {'class': 'form-label'}}) }}
					{{ form_widget(form.premiereFacturation, {'attr': {'class': 'form-control datepicker'}}) }}
				</div>
			</div>

			<div class="row">
				<div class="col-md-6 mb-3">
					<div class="form-check form-switch">
						{{ form_widget(form.accordSigne, {'attr': {'class': 'form-check-input'}}) }}
						{{ form_label(form.accordSigne, 'Accord signé', {'label_attr': {'class': 'form-check-label'}}) }}
					</div>
				</div>
				<div class="col-md-6 mb-3">
					<div class="form-check form-switch">
						{{ form_widget(form.refuse, {'attr': {'class': 'form-check-input'}}) }}
						{{ form_label(form.refuse, 'Refusé', {'label_attr': {'class': 'form-check-label'}}) }}
					</div>
				</div>
			</div>
		</div>
	</div>
</div>


{# Section Actions #}
<div class="col-12">
    <div class="card mb-4 shadow-sm">
        <div class="card-header bg-primary text-white">
            <h5 class="mb-0">Actions à appliquer</h5>
        </div>
        <div class="card-body">
            {{ form_label(form.actions, null, {'label_attr': {'class': 'form-label fw-bold'}}) }}
            <div class="row">
                {% for checkbox in form.actions %}
                    <div class="col-md-3 mb-2">
                        <div class="form-check">
                            {{ form_widget(checkbox, {'attr': {'class': 'form-check-input'}}) }}
                            {{ form_label(checkbox, null, {'label_attr': {'class': 'form-check-label'}}) }}
                        </div>
                    </div>
                {% endfor %}
            </div>
            {{ form_errors(form.actions) }}
        </div>
    </div>
</div>

<div class="col-12">
	<div class="card shadow-sm">
		<div class="card-body d-flex justify-content-between">
			<button type="submit" class="btn btn-primary">
				<i class="bi bi-check-circle me-2"></i>
				{{ button_label|default('Enregistrer') }}
			</button>

		</div>
	</div>
</div>

{{ form_end(form) }}

{# Script pour la validation des champs et datepicker #}
{% block javascripts %} <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
	 <script>
		// Validation Bootstrap
		(() => {
		  'use strict'
		  const forms = document.querySelectorAll('.needs-validation')
		  Array.from(forms).forEach(form => {
		    form.addEventListener('submit', event => {
		      if (!form.checkValidity()) {
		        event.preventDefault()
		        event.stopPropagation()
		      }
		      form.classList.add('was-validated')
		    }, false)
		  })
		})()
		
		// Initialisation des datepickers (si vous utilisez flatpickr par exemple)
		document.addEventListener('DOMContentLoaded', function() {
		    flatpickr('.datepicker', {
		        dateFormat: 'd/m/Y',
		        locale: 'fr'
		    });
		});
		</script>
{% endblock %}
